import React, { useMemo, useState } from "react";

/**
 * Gu√≠a de Estudio Espa√±ol (SPA en React)
 * - P√°gina principal con video de resumen (enlazado a GitHub RAW o similar)
 * - 8 secciones con res√∫menes claros para un(a) estudiante de 14 a√±os
 * - Quiz por secci√≥n (5 preguntas, aleatorio cada vez)
 * - Quiz General (20 preguntas de todo el material, aleatorio cada vez)
 *
 * üëâ Instrucciones r√°pidas
 * 1) Cambia VIDEO_URL por el enlace RAW del video en tu GitHub.
 * 2) Si lo deseas, agrega m√°s preguntas a cada banco (respetando el formato).
 * 3) Exporta este archivo como un √∫nico componente y pr√©visualo.
 */

// ‚Üê‚Äî Cambia este enlace por el RAW del video de tu repo GitHub
const VIDEO_URL = "https://raw.githubusercontent.com/tu-usuario/tu-repo/main/video_resumen.mp4";

// Utilidad: barajar array (Fisher‚ÄìYates)
function shuffleArray<T>(arr: T[]): T[] {
  const a = [...arr];
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

// Tipos
type Question = {
  prompt: string;
  options: string[];
  answerIndex: number;
  explanation?: string;
};

type SectionKey =
  | "seccion1"
  | "seccion2"
  | "seccion3"
  | "seccion4"
  | "seccion5"
  | "seccion6"
  | "seccion7"
  | "seccion8";


type Page = { type: "home" } | { type: "section"; key: SectionKey } | { type: "generalQuiz" };

// ‚Äî‚Äî Banco de preguntas por secci√≥n ‚Äî‚Äî //
// Bot√≥n 1: TEMA 1 Y 2. TEXTOS DESCRIPTIVOS, EXPOSITIVOS Y ARGUMENTATIVOS.
const bank1: Question[] = [
  { prompt: "¬øCu√°l es el prop√≥sito principal de un texto expositivo?", options: ["Persuadir al lector", "Informar de forma objetiva", "Provocar emociones", "Narrar en primera persona"], answerIndex: 1, explanation: "El texto expositivo busca informar de forma objetiva y clara." },
  { prompt: "En un texto argumentativo, la tesis es‚Ä¶", options: ["Un dato verificado", "La opini√≥n que se defiende", "Una an√©cdota", "El t√≠tulo del texto"], answerIndex: 1, explanation: "La tesis es la postura u opini√≥n central que el autor intenta sostener." },
  { prompt: "¬øQu√© diferencia a la idea principal de una idea secundaria?", options: ["La principal adorna; la secundaria da sentido", "La principal es el n√∫cleo; la secundaria ampl√≠a o explica", "La secundaria es m√°s importante", "No hay diferencia"], answerIndex: 1 },
  { prompt: "Un ejemplo de conector de contraste es‚Ä¶", options: ["Adem√°s", "Por lo tanto", "Sin embargo", "Luego"], answerIndex: 2 },
  { prompt: "Identifica la opci√≥n que muestra informaci√≥n sustentada:", options: ["Creo que los videojuegos son malos", "Un estudio report√≥ que el 60% juega a diario", "En mi opini√≥n, estudiar es aburrido", "A m√≠ me parece que leer cansa"], answerIndex: 1 },
  { prompt: "¬øCu√°l de estos recursos ayuda a organizar y clarificar informaci√≥n?", options: ["Met√°foras complejas", "Tablas e im√°genes pertinentes", "Rimas y versos", "Onomatopeyas"], answerIndex: 1 },
  { prompt: "Un texto argumentativo t√≠pico se organiza en‚Ä¶", options: ["Planteamiento, nudo y desenlace", "Introducci√≥n (tesis), cuerpo (argumentos) y conclusi√≥n", "Inicio, desarrollo libre", "Solo citas de autoridad"], answerIndex: 1 },
  { prompt: "¬øQu√© funci√≥n cumplen los ejemplos en un texto expositivo?", options: ["Emocionar", "Embellecer", "Aclarar conceptos y hacerlos comprensibles", "Crear rima"], answerIndex: 2 },
];

// Bot√≥n 2: TEMA 3. ESTRUCTURA DE UNA NARRACI√ìN Y UNA OBRA DRAM√ÅTICA.
const bank2: Question[] = [
  { prompt: "La estructura cl√°sica de la narraci√≥n es‚Ä¶", options: ["Exposici√≥n, refutaci√≥n, conclusi√≥n", "Introducci√≥n, nudo y desenlace", "Actos y escenas", "Planteamiento √∫nico"], answerIndex: 1 },
  { prompt: "¬øCu√°l de las siguientes NO es una funci√≥n del narrador?", options: ["Contar hechos", "Describir escenarios", "Actuar como personaje en escena con acotaciones", "Presentar la perspectiva de la historia"], answerIndex: 2 },
  { prompt: "En una obra dram√°tica, las acotaciones sirven para‚Ä¶", options: ["Introducir rimas", "Indicar acciones, gestos y ambiente esc√©nico", "Explicar la voz del narrador", "Dar bibliograf√≠a"], answerIndex: 1 },
  { prompt: "El conflicto en una narraci√≥n‚Ä¶", options: ["No importa", "Es el choque de fuerzas que impulsa la trama", "Solo existe en la poes√≠a", "Es un recurso de puntuaci√≥n"], answerIndex: 1 },
  { prompt: "Una obra dram√°tica se organiza en‚Ä¶", options: ["Cap√≠tulos", "Actos y escenas", "Versos", "Partes libres"], answerIndex: 1 },
  { prompt: "El mon√≥logo en el drama se usa para‚Ä¶", options: ["Describir paisajes", "Mostrar pensamientos internos de un personaje", "Anunciar el t√≠tulo", "Cambiar el narrador"], answerIndex: 1 },
];

// Bot√≥n 3: TEMA 4. FUNCIONES EST√âTICAS Y SIMB√ìLICAS.
const bank3: Question[] = [
  { prompt: "Una funci√≥n est√©tica de los recursos literarios es‚Ä¶", options: ["Probar cient√≠ficamente", "Embellecer el texto y crear atm√≥sfera", "Traducir datos", "Definir leyes"], answerIndex: 1 },
  { prompt: "Una funci√≥n simb√≥lica consiste en‚Ä¶", options: ["Hacer re√≠r", "Dar significados m√°s profundos (paloma = paz)", "Cerrar un poema", "Cambiar el tiempo verbal"], answerIndex: 1 },
  { prompt: "Identifica la met√°fora:", options: ["Tus ojos son estrellas", "Tus ojos brillan como estrellas", "Tienes ojos bonitos", "Tus ojos azules"], answerIndex: 0 },
  { prompt: "¬øPor qu√© importan los s√≠mbolos en textos literarios?", options: ["Porque alargan el texto", "Porque a√±aden emoci√≥n y niveles de significado", "Porque quitan rima", "Porque quitan ritmo"], answerIndex: 1 },
  { prompt: "Un motivo que se repite sirve para‚Ä¶", options: ["Rellenar p√°ginas", "Reforzar el tema central", "Cambiar el g√©nero", "Eliminar descripciones"], answerIndex: 1 },
];

// Bot√≥n 4: TEMA 5. TEMAS LITERARIOS EN TEXTOS NARRATIVOS, L√çRICOS Y DRAM√ÅTICOS.
const bank4: Question[] = [
  { prompt: "El 'tema' de un texto es‚Ä¶", options: ["El argumento detallado", "La idea central que recorre la obra", "El nombre del protagonista", "El g√©nero literario"], answerIndex: 1 },
  { prompt: "En un poema, un tema frecuente de la l√≠rica es‚Ä¶", options: ["Instructivos", "Amor y paso del tiempo", "Balance contable", "Contrato de arrendamiento"], answerIndex: 1 },
  { prompt: "En una obra dram√°tica, un tema puede explorarse mediante‚Ä¶", options: ["Acotaciones exclusivamente", "Di√°logos y conflictos de personajes", "Tablas comparativas", "Notas al pie"], answerIndex: 1 },
  { prompt: "En narrativa, el tema se refuerza con‚Ä¶", options: ["Conflictos, s√≠mbolos y motivos", "Solo descripciones", "Salto de p√°gina", "√çndice"], answerIndex: 0 },
  { prompt: "¬øQu√© enuncia mejor un tema?", options: ["'El abuelo se enferma'", "'La fragilidad de la vida'", "'La casa es azul'", "'Se casan al final'"], answerIndex: 1 },
];

// Bot√≥n 5: TEMA 6 Y 7. ELEMENTOS B√ÅSICOS DE DOCUMENTOS LEGALES Y ADMINISTRATIVOS SENCILLOS.
const bank5: Question[] = [
  { prompt: "Un documento administrativo sencillo (oficio/solicitud) debe incluir‚Ä¶", options: ["Met√°foras", "Datos del remitente y destinatario, asunto, fecha y firma", "Rimas", "Ilustraciones"], answerIndex: 1 },
  { prompt: "El tono apropiado en un documento legal/administrativo es‚Ä¶", options: ["Coloquial", "Formal, claro y respetuoso", "Po√©tico", "Sarcasmo"], answerIndex: 1 },
  { prompt: "¬øQu√© parte explica el prop√≥sito del documento?", options: ["Asunto", "Firma", "Anexo", "Saludo"], answerIndex: 0 },
  { prompt: "La 'carta poder' es‚Ä¶", options: ["Un poema", "Un documento para autorizar a otra persona a actuar", "Un folleto", "Un instructivo"], answerIndex: 1 },
  { prompt: "En un formato, los 'anexos' se refieren a‚Ä¶", options: ["Saludos", "Documentos adjuntos que respaldan la solicitud", "Bromas", "Notas de autor"], answerIndex: 1 },
];

// Bot√≥n 6: TEMA 8. ART√çCULO DE OPINI√ìN.
const bank6: Question[] = [
  { prompt: "Un art√≠culo de opini√≥n es‚Ä¶", options: ["Un texto expositivo", "Un texto argumentativo con postura del autor", "Un instructivo", "Una rese√±a t√©cnica"], answerIndex: 1 },
  { prompt: "La parte donde se presentan las pruebas y razones es‚Ä¶", options: ["T√≠tulo", "Cuerpo del art√≠culo", "Ep√≠grafe", "Cr√©ditos"], answerIndex: 1 },
  { prompt: "¬øQu√© conector expresa consecuencia?", options: ["Sin embargo", "Aunque", "Por lo tanto", "Pero"], answerIndex: 2 },
  { prompt: "Para fortalecer un argumento conviene‚Ä¶", options: ["Evitar datos", "Usar datos verificables y citas de autoridad", "Usar rima", "Cambiar de tema"], answerIndex: 1 },
  { prompt: "La conclusi√≥n de un art√≠culo de opini√≥n debe‚Ä¶", options: ["Abrir nuevos temas sin relaci√≥n", "Reafirmar la postura y propuestas", "Eliminar la tesis", "Usar versos"], answerIndex: 1 },
];

// Bot√≥n 7: TEMA 9. REGLAS DE SINTAXIS Y MORFOLOG√çA.
const bank7: Question[] = [
  { prompt: "La sintaxis estudia‚Ä¶", options: ["El origen de las palabras", "El orden y relaci√≥n de palabras en la oraci√≥n", "La ortograf√≠a de nombres propios", "El n√∫mero de s√≠labas"], answerIndex: 1 },
  { prompt: "Identifica la oraci√≥n correcta:", options: ["Libro un lee Mar√≠a", "Mar√≠a lee un libro", "Lee Mar√≠a un libro libro", "Mar√≠a libro un lee"], answerIndex: 1 },
  { prompt: "La morfolog√≠a analiza‚Ä¶", options: ["S√≥lo la rima", "La estructura y formaci√≥n de las palabras", "La m√©trica", "Los signos de puntuaci√≥n"], answerIndex: 1 },
  { prompt: "La concordancia sujeto‚Äìverbo correcta implica‚Ä¶", options: ["Sujeto singular con verbo plural siempre", "Coincidencia en n√∫mero y persona", "Cambiar tiempos sin raz√≥n", "Eliminar el sujeto"], answerIndex: 1 },
  { prompt: "¬øQu√© es un prefijo?", options: ["Parte final de la palabra", "Elemento que se antepone a la ra√≠z para modificar significado", "Signo de puntuaci√≥n", "Tiempo verbal"], answerIndex: 1 },
];

// Bot√≥n 8: TEMA 10. COHESI√ìN EN TEXTOS.
const bank8: Question[] = [
  { prompt: "La cohesi√≥n textual se logra con‚Ä¶", options: ["P√°rrafos inconexos", "Conectores, referencias (an√°foras/cat√°foras) y elipsis", "Cambios bruscos de tema", "Rimas"], answerIndex: 1 },
  { prompt: "¬øQu√© signo introduce una lista o explicaci√≥n?", options: [";", ",", ":", "."], answerIndex: 2 },
  { prompt: "Un conector de adici√≥n es‚Ä¶", options: ["Adem√°s", "Sin embargo", "Por lo tanto", "No obstante"], answerIndex: 0 },
  { prompt: "La referencia anaf√≥rica consiste en‚Ä¶", options: ["Adelantar una idea", "Retomar un elemento ya mencionado (p. ej., 'Mar√≠a‚Ä¶ ella‚Ä¶')", "Rimar dos versos", "Eliminar sujetos"], answerIndex: 1 },
  { prompt: "Para evitar repeticiones se puede usar‚Ä¶", options: ["Sustituci√≥n l√©xica, pronombres y sin√≥nimos", "Repetici√≥n constante", "Rima consonante", "May√∫sculas"], answerIndex: 0 },
];

const sectionBanks
: Record<SectionKey, Question[]> = {
  seccion1: bank1,
  seccion2: bank2,
  seccion3: bank3,
  seccion4: bank4,
  seccion5: bank5,
  seccion6: bank6,
  seccion7: bank7,
  seccion8: bank8,
};

// ‚Äî‚Äî Res√∫menes por secci√≥n (lenguaje claro para 14 a√±os) ‚Äî‚Äî //
const SectionSummaries: Record<SectionKey, { title: string; summary: React.ReactNode }> = {
  seccion1: {
    title: "TEMA 1 Y 2. TEXTOS DESCRIPTIVOS, EXPOSITIVOS Y ARGUMENTATIVOS.",
    summary: (
      <div className="space-y-4 text-base leading-relaxed">
        <h3 className="text-xl font-semibold">Prop√≥sito del tema</h3>
        <p>Distinguir ideas principales/ secundarias, diferenciar informaci√≥n sustentada de opini√≥n y dominar estructura y recursos de textos expositivos, argumentativos y descriptivos.</p>

        <h4 className="font-semibold">Ideas principales vs. secundarias</h4>
        <ul className="list-disc pl-5 space-y-1">
          <li><strong>Idea principal</strong>: n√∫cleo del p√°rrafo; si se elimina, el texto pierde sentido.</li>
          <li><strong>Ideas secundarias</strong>: ampl√≠an, ejemplifican o explican la idea principal.</li>
          <li><strong>C√≥mo identificarlas</strong>: localiza la oraci√≥n que condensa el mensaje; el resto desarrolla o sustenta.</li>
        </ul>

        <h4 className="font-semibold">Informaci√≥n sustentada vs. opini√≥n</h4>
        <ul className="list-disc pl-5 space-y-1">
          <li><strong>Informaci√≥n sustentada</strong>: hechos verificables, datos, estad√≠sticas, evidencias y fuentes confiables.</li>
          <li><strong>Opini√≥n</strong>: juicios personales ("creo que‚Ä¶", "opino que‚Ä¶").</li>
          <li><strong>Distinci√≥n pr√°ctica</strong>: detecta marcadores de postura y exige pruebas/argumentos que respalden la afirmaci√≥n.</li>
        </ul>

        <h4 className="font-semibold">Textos expositivos</h4>
        <ul className="list-disc pl-5 space-y-1">
          <li><strong>Prop√≥sito</strong>: informar objetivamente.</li>
          <li><strong>Estructura</strong>: introducci√≥n ‚Üí desarrollo ‚Üí conclusi√≥n.</li>
          <li><strong>Organizaci√≥n</strong>: clara, ordenada; lenguaje preciso y formal.</li>
          <li><strong>Recursos</strong>: ejemplos, definiciones, <em>tablas e im√°genes</em> para agilizar comprensi√≥n.</li>
          <li><strong>Pertinencia</strong>: eval√∫a si el recurso aporta claridad o distrae; debe integrarse al contenido.</li>
        </ul>

        <h4 className="font-semibold">Textos argumentativos</h4>
        <ul className="list-disc pl-5 space-y-1">
          <li><strong>Prop√≥sito</strong>: persuadir/defender una <em>tesis</em>.</li>
          <li><strong>Estructura</strong>: introducci√≥n (tesis) ‚Üí cuerpo (argumentos y pruebas) ‚Üí conclusi√≥n.</li>
          <li><strong>Organizaci√≥n</strong>: argumentos conectados y jerarquizados para convencer.</li>
        </ul>

        <h4 className="font-semibold">Conectores discursivos</h4>
        <ul className="list-disc pl-5 space-y-1">
          <li><strong>Funci√≥n</strong>: enlazan ideas (causa, consecuencia, adici√≥n, contraste) y dan cohesi√≥n.</li>
          <li><strong>Ejemplo integrado</strong>: "La sequ√≠a afecta los cultivos; <em>sin embargo</em>, las inundaciones tambi√©n generan problemas. <em>Adem√°s</em>, falta agua para riego. <em>En consecuencia</em>, se pierden cosechas."</li>
        </ul>

        <h4 className="font-semibold">Redacci√≥n de explicaciones (profundizaci√≥n)</h4>
        <p>Desarrolla cada punto del esquema con definiciones, causas/efectos y descripciones. Ejemplo: "Las sequ√≠as reducen el agua de riego; las inundaciones da√±an infraestructura y cultivos, generando p√©rdidas econ√≥micas."</p>

        <h4 className="font-semibold">Texto descriptivo</h4>
        <ul className="list-disc pl-5 space-y-1">
          <li>Retrata rasgos con lenguaje sensorial y orden l√≥gico (primero/luego/por √∫ltimo).</li>
        </ul>
      </div>
    ),
  },
  seccion2: {
    title: "TEMA 3. ESTRUCTURA DE UNA NARRACI√ìN Y UNA OBRA DRAM√ÅTICA.",
    summary: (
      <div className="space-y-4 text-base leading-relaxed">
        <h4 className="font-semibold">Narraci√≥n</h4>
        <ul className="list-disc pl-5 space-y-1">
          <li>Estructura: <strong>introducci√≥n</strong>, <strong>nudo</strong> y <strong>desenlace</strong>.</li>
          <li>Componentes: narrador (1¬™/3¬™), personajes, tiempo y espacio.</li>
          <li>El <strong>conflicto</strong> impulsa la trama; el punto de vista modifica la experiencia del lector.</li>
          <li><strong>Ejemplo de desarrollo</strong>: "El sol se pon√≠a‚Ä¶ el viajero, agotado‚Ä¶" (la voz del narrador describe acciones y ambiente).</li>
        </ul>
        <h4 className="font-semibold">Drama</h4>
        <ul className="list-disc pl-5 space-y-1">
          <li>Se organiza en <strong>actos</strong> y <strong>escenas</strong>.</li>
          <li>Avanza mediante <strong>di√°logos</strong> y <strong>acciones</strong> en escena.</li>
          <li><strong>Acotaciones</strong>: instrucciones esc√©nicas (p. ej., <em>(grita con enojo)</em>, <em>(entra llorando)</em>).</li>
          <li><strong>Mon√≥logos</strong>: muestran pensamientos y emociones internas.</li>
          <li>Comparativa clave (Narraci√≥n vs. Drama): la primera describe con voz narrativa; el segundo muestra en escena.</li>
        </ul>
        <h4 className="font-semibold">Poes√≠a</h4>
        <ul className="list-disc pl-5 space-y-1">
          <li>An√°lisis de <strong>m√©trica</strong>, <strong>rima</strong> y <strong>verso libre</strong> para ritmo y significado.</li>
        </ul>
      </div>
    ),
  },
  seccion3: {
    title: "TEMA 4. FUNCIONES EST√âTICAS Y SIMB√ìLICAS.",
    summary: (
      <div className="space-y-4 text-base leading-relaxed">
        <h4 className="font-semibold">¬øPara qu√© sirven?</h4>
        <ul className="list-disc pl-5 space-y-1">
          <li><strong>Funciones est√©ticas</strong>: embellecimiento ("tus ojos son dos luceros"), creaci√≥n de atm√≥sfera/estilo, y mayor expresividad (hip√©rboles como "lloraba mares").</li>
          <li><strong>Funciones simb√≥licas</strong>: aportan profundidad y varios niveles de significado (paloma = paz/libertad/esperanza); permiten expresar ideas abstractas y emociones.</li>
        </ul>
        <h4 className="font-semibold">Seg√∫n el tipo de texto</h4>
        <ul className="list-disc pl-5 space-y-1">
          <li><strong>L√≠rica</strong>: met√°foras y s√≠mbolos para sentimientos ("El amor es un campo de batalla").</li>
          <li><strong>Narrativa</strong>: motivos que se repiten (la lluvia como s√≠mbolo de tristeza) para reforzar el tema.</li>
          <li><strong>Drama</strong>: acotaciones que indican gestos/ambiente y gu√≠an la interpretaci√≥n.</li>
        </ul>
        <h4 className="font-semibold">Indicadores de an√°lisis</h4>
        <ul className="list-disc pl-5 space-y-1">
          <li>S√≠mbolos y met√°foras (rosa = amor; "tus ojos son estrellas").</li>
          <li>Motivos y temas (repeticiones significativas que orientan la lectura).</li>
          <li>Papel de las acotaciones para emoci√≥n, ambiente y construcci√≥n de personajes.</li>
        </ul>
      </div>
    ),
  },
  seccion4: {
    title: "TEMA 5. TEMAS LITERARIOS EN TEXTOS NARRATIVOS, L√çRICOS Y DRAM√ÅTICOS.",
    summary: (
      <div className="space-y-4 text-base leading-relaxed">
        <p>Estudio del <strong>tema</strong> como idea central (amor, justicia, identidad, miedo, etc.) y c√≥mo se manifiesta por conflictos, s√≠mbolos, motivos, tono y voz po√©tica.</p>
        <h4 className="font-semibold">Adaptaci√≥n y reinterpretaci√≥n</h4>
        <ul className="list-disc pl-5 space-y-1">
          <li><strong>Adaptaci√≥n</strong>: traslado del tema a otro medio (cine, pintura, m√∫sica) conservando su esencia pero ajust√°ndolo al nuevo lenguaje.</li>
          <li><strong>Reinterpretaci√≥n</strong>: el nuevo medio modifica el enfoque y expresividad del tema original.</li>
          <li><strong>Objetivo del an√°lisis</strong>: comparar similitudes/diferencias entre original y adaptaci√≥n, y c√≥mo cambia el impacto.</li>
        </ul>
      </div>
    ),
  },
  seccion5: {
    title: "TEMA 6 Y 7. ELEMENTOS B√ÅSICOS DE DOCUMENTOS LEGALES Y ADMINISTRATIVOS SENCILLOS.",
    summary: (
      <div className="space-y-4 text-base leading-relaxed">
        <h4 className="font-semibold">Partes y formato</h4>
        <ul className="list-disc pl-5 space-y-1">
          <li>Remitente, destinatario, asunto, fecha, cuerpo, cierre, firma y anexos.</li>
          <li>Tono <strong>formal</strong>, claro y respetuoso; datos completos y orden.</li>
        </ul>
        <h4 className="font-semibold">Ejemplos y conceptos</h4>
        <ul className="list-disc pl-5 space-y-1">
          <li><strong>Carta poder</strong>: autoriza a otra persona a actuar en tu nombre.</li>
          <li><strong>Oficio/solicitud</strong>: comunican o piden algo a una autoridad o instituci√≥n.</li>
          <li><strong>Anexos</strong>: documentos que respaldan la solicitud.</li>
        </ul>
      </div>
    ),
  },
  seccion6: {
    title: "TEMA 8. ART√çCULO DE OPINI√ìN",
    summary: (
      <div className="space-y-4 text-base leading-relaxed">
        <h4 className="font-semibold">Estructura y rasgos</h4>
        <ul className="list-disc pl-5 space-y-1">
          <li>T√≠tulo; introducci√≥n (plantea tema y postura); <strong>cuerpo</strong> con argumentos basados en datos/citas; <strong>conclusi√≥n</strong> que reafirma postura y propone.</li>
          <li>Uso de conectores (consecuencia, contraste, adici√≥n) y registro formal.</li>
          <li>Evitar falacias y generalizaciones; apoyar con evidencia verificable.</li>
        </ul>
      </div>
    ),
  },
  seccion7: {
    title: "TEMA 9. REGLAS DE SINTAXIS Y MORFOLOG√çA.",
    summary: (
      <div className="space-y-4 text-base leading-relaxed">
        <ul className="list-disc pl-5 space-y-1">
          <li><strong>Sintaxis</strong>: orden y relaci√≥n de palabras; funciones (sujeto, predicado, complementos).</li>
          <li><strong>Morfolog√≠a</strong>: estructura de palabras (ra√≠z, prefijos, sufijos) y procesos de formaci√≥n.</li>
          <li><strong>Concordancia</strong>: coincidencia n√∫mero/persona entre sujeto y verbo.</li>
          <li><strong>Prefijo</strong>: elemento que se antepone a la ra√≠z para modificar significado.</li>
        </ul>
      </div>
    ),
  },
  seccion8: {
    title: "TEMA 10. COHESI√ìN EN TEXTOS",
    summary: (
      <div className="space-y-4 text-base leading-relaxed">
        <h4 className="font-semibold">Mecanismos de cohesi√≥n</h4>
        <ul className="list-disc pl-5 space-y-1">
          <li><strong>Conectores</strong>: adici√≥n (adem√°s), contraste (sin embargo), causa (porque), consecuencia (por lo tanto), orden (primero/luego), ejemplificaci√≥n (por ejemplo).</li>
          <li><strong>Referencias</strong>: an√°fora (retoma elemento previo), cat√°fora (anticipa), elipsis (omisi√≥n recuperable), sustituci√≥n l√©xica y sinonimia.</li>
          <li><strong>Puntuaci√≥n</strong>: dos puntos para introducir listas/explicaciones; punto y coma para separar ideas relacionadas; comas (enumerativas/explicativas) para claridad.</li>
        </ul>
      </div>
    ),
  },
};

// ‚Äî‚Äî Componente de Quiz reutilizable ‚Äî‚Äî //
function Quiz({ bank, numQuestions, title, onBack }: { bank: Question[]; numQuestions: number; title: string; onBack: () => void }) {
  const [seed, setSeed] = useState(0); // para regenerar versi√≥n
  const questions = useMemo(() => {
    const picked = shuffleArray(bank).slice(0, numQuestions).map((q) => {
      const shuffled = shuffleArray(q.options);
      const correctText = q.options[q.answerIndex];
      const newAnswerIndex = shuffled.findIndex((o) => o === correctText);
      return { ...q, options: shuffled, answerIndex: newAnswerIndex };
    });
    return picked;
  }, [bank, numQuestions, seed]);

  const [answers, setAnswers] = useState<(number | null)[]>(Array(questions.length).fill(null));
  const [submitted, setSubmitted] = useState(false);

  const score = useMemo(() => {
    if (!submitted) return 0;
    return questions.reduce((acc, q, i) => {
      const chosen = answers[i];
      return acc + (chosen === q.answerIndex ? 1 : 0);
    }, 0);
  }, [submitted, answers, questions]);

  function handleSelect(qi: number, oi: number) {
    if (submitted) return;
    const copy = [...answers];
    copy[qi] = oi;
    setAnswers(copy);
  }

  function handleSubmit() {
    setSubmitted(true);
  }

  function regenerate() {
    setSeed((s) => s + 1);
    setAnswers(Array(numQuestions).fill(null));
    setSubmitted(false);
  }

  return (
    <div className="max-w-3xl mx-auto p-4">
      <div className="mb-4 flex items-center justify-between">
        <h2 className="text-2xl font-semibold">{title}</h2>
        <button onClick={onBack} className="px-3 py-1.5 rounded-xl bg-gray-100 hover:bg-gray-200 transition">‚Üê Regresar</button>
      </div>

      <div className="space-y-6">
        {questions.map((q, qi) => (
          <div key={qi} className="rounded-2xl p-4 shadow border">
            <div className="font-medium mb-3">{qi + 1}. {q.prompt}</div>
            <div className="grid gap-2">
              {q.options.map((opt, oi) => (
                <label key={oi} className={`flex items-center gap-2 rounded-xl border p-2 cursor-pointer ${answers[qi] === oi ? "bg-blue-50 border-blue-300" : "hover:bg-gray-50"}`}>
                  <input
                    type="radio"
                    className="accent-black"
                    checked={answers[qi] === oi}
                    onChange={() => handleSelect(qi, oi)}
                  />
                  <span>{opt}</span>
                </label>
              ))}
            </div>
            {submitted && (
              <div className="mt-3 text-sm">
                {(() => {
                  const chosen = answers[qi];
                  const correctText = q.options[q.answerIndex];
                  const ok = chosen === q.answerIndex;
                  return (
                    <div>
                      {ok ? (
                        <div className="text-green-700">‚úî Correcto</div>
                      ) : (
                        <div className="text-red-700">‚úò Incorrecto. Respuesta correcta: <strong>{correctText}</strong>{q.explanation ? ` ‚Äî ${q.explanation}` : ""}</div>
                      )}
                    </div>
                  );
                })()}
              </div>
            )}
          </div>
        ))}
      </div>

      <div className="mt-6 flex items-center gap-3">
        {!submitted ? (
          <button onClick={handleSubmit} className="px-4 py-2 rounded-2xl bg-black text-white shadow hover:opacity-90">Enviar respuestas</button>
        ) : (
          <>
            <div className="text-lg">Puntaje: <strong>{score}/{questions.length}</strong></div>
            <button onClick={regenerate} className="px-4 py-2 rounded-2xl bg-gray-900 text-white shadow hover:opacity-90">Intentar otra versi√≥n</button>
          </>
        )}
      </div>
    </div>
  );
}

// ‚Äî‚Äî P√°ginas de Secci√≥n (resumen + bot√≥n al quiz de 5 preguntas) ‚Äî‚Äî //
function SectionPage({ sectionKey, onBack, onStartQuiz }: { sectionKey: SectionKey; onBack: () => void; onStartQuiz: () => void }) {
  const { title, summary } = SectionSummaries[sectionKey];
  return (
    <div className="max-w-3xl mx-auto p-4">
      <div className="mb-4 flex items-center justify-between">
        <h2 className="text-2xl font-semibold">{title}</h2>
        <button onClick={onBack} className="px-3 py-1.5 rounded-xl bg-gray-100 hover:bg-gray-200 transition">‚Üê Regresar</button>
      </div>

      <div className="prose max-w-none mb-8">
        {summary}
      </div>

      <div className="mt-8 border-t pt-6">
        <button onClick={onStartQuiz} className="px-4 py-2 rounded-2xl bg-black text-white shadow hover:opacity-90">
          Hacer quiz de esta secci√≥n (5 preguntas)
        </button>
      </div>
    </div>
  );
}

// ‚Äî‚Äî P√°gina principal ‚Äî‚Äî //
export default function App() {
  const [page, setPage] = useState<Page>({ type: "home" });
  const [activeSection, setActiveSection] = useState<SectionKey | null>(null);

  const goHome = () => setPage({ type: "home" });

  // Render condicional segun p√°gina
  if (page.type === "section" && activeSection) {
    const bank = sectionBanks[activeSection];
    const title = `Quiz ‚Äì ${SectionSummaries[activeSection].title}`;
    return (
      <div className="min-h-screen bg-gradient-to-b from-white to-gray-50">
        <SectionPage
          sectionKey={activeSection}
          onBack={goHome}
          onStartQuiz={() => setPage({ type: "section" })}
        />
        {/* Si el usuario presiona el bot√≥n, mostramos el quiz inmediatamente debajo */}
        <div className="pb-16">
          <Quiz bank={bank} numQuestions={5} title={title} onBack={goHome} />
        </div>
      </div>
    );
  }

  if (page.type === "generalQuiz") {
    // Banco general: todas las preguntas
    const fullBank = [
      ...bank1,
      ...bank2,
      ...bank3,
      ...bank4,
      ...bank5,
      ...bank6,
      ...bank7,
      ...bank8,
    ];
    return (
      <div className="min-h-screen bg-gradient-to-b from-white to-gray-50">
        <Quiz bank={fullBank} numQuestions={20} title="Quiz General (20 preguntas)" onBack={goHome} />
      </div>
    );
  }

  // P√°gina de inicio
  return (
    <div className="min-h-screen bg-gradient-to-b from-white to-gray-50">
      <header className="px-6 pt-10 pb-6 text-center">
        <h1 className="text-4xl font-bold tracking-tight">Gu√≠a de Estudio Espa√±ol</h1>
        <p className="mt-2 text-gray-600">Resumen general, secciones con apuntes claros y quizzes auto-generados.</p>
      </header>

      <main className="max-w-4xl mx-auto p-4">
        {/* Ventana de video */}
        <div className="rounded-2xl overflow-hidden shadow border bg-black aspect-video mb-8">
          <video controls src={VIDEO_URL} className="w-full h-full" />
        </div>

        {/* Botones de secciones */}
        <div className="grid sm:grid-cols-2 gap-4 mb-8">
          {(() => {
            const menu: { key: SectionKey; label: string }[] = [
              { key: "seccion1", label: "TEMA 1 Y 2. TEXTOS DESCRIPTIVOS, EXPOSITIVOS Y ARGUMENTATIVOS." },
              { key: "seccion2", label: "TEMA 3. ESTRUCTURA DE UNA NARRACI√ìN Y UNA OBRA DRAM√ÅTICA." },
              { key: "seccion3", label: "TEMA 4. FUNCIONES EST√âTICAS Y SIMB√ìLICAS." },
              { key: "seccion4", label: "TEMA 5. TEMAS LITERARIOS EN TEXTOS NARRATIVOS, L√çRICOS Y DRAM√ÅTICOS." },
              { key: "seccion5", label: "TEMA 6 Y 7. ELEMENTOS B√ÅSICOS DE DOCUMENTOS LEGALES Y ADMINISTRATIVOS SENCILLOS." },
              { key: "seccion6", label: "TEMA 8. ART√çCULO DE OPINI√ìN" },
              { key: "seccion7", label: "TEMA 9. REGLAS DE SINTAXIS Y MORFOLOG√çA." },
              { key: "seccion8", label: "TEMA 10. COHESI√ìN EN TEXTOS" },
            ];
            return menu.map(({ key, label }, idx) => (
              <button
                key={key}
                onClick={() => { setActiveSection(key); setPage({ type: "section", key }); }}
                className="text-left p-4 rounded-2xl border shadow hover:shadow-md hover:-translate-y-0.5 transition"
              >
                <div className="text-sm text-gray-500">Secci√≥n {idx + 1}</div>
                <div className="text-lg font-semibold">{label}</div>
                <div className="mt-1 text-gray-600 line-clamp-2">Accede al resumen y practica con un quiz de 5 preguntas.</div>
              </button>
            ));
          })()}
        </div>

        {/* Link al Quiz General */}
        <div className="text-center mb-16">
          <button
            onClick={() => setPage({ type: "generalQuiz" })}
            className="px-6 py-3 rounded-2xl bg-black text-white font-medium shadow hover:opacity-90"
          >
            Hacer Quiz General (20 preguntas)
          </button>
          <p className="text-sm text-gray-600 mt-2">Cada intento genera una versi√≥n diferente.</p>
        </div>
      </main>

      <footer className="text-center text-xs text-gray-500 pb-8">
        "Pluto el que lo lea"
      </footer>
    </div>
  );
}
